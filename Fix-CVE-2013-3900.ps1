#This script does the following:

#Disables the ability to preview RTF files in Outlook
#Disables the ability to open RTF files in Word
#Disables the ability to open RTF files in Excel

#Open Notepad or another text editor.

#Copy and paste the Powershell script provided into the text editor.

#Save the file with a .ps1 extension, such as fix-cve-2013-3900.ps1.

#Open Powershell as an administrator.

#Navigate to the directory where the script is saved using the cd command. For example, if the script is saved on the desktop, 
#you would type cd C:\Users\Username\Desktop.

#Run the script by typing the filename (including the .ps1 extension) and pressing Enter. For example, you would type fix-cve-2013-3900.ps1.

#Note that you may need to adjust your system's execution policy to run the script. You can do this by opening Powershell as an administrator
#and running the command Set-ExecutionPolicy RemoteSigned. This will allow you to run locally created Powershell scripts.

#After running the script, the registry keys will be updated to disable RTF file handling in Outlook, Word, and Excel, 
#helping to mitigate the CVE-2013-3900 vulnerability.



# Disable the ability to preview RTF files in Outlook
New-ItemProperty -Path "HKCU:\Software\Microsoft\Office\*\Outlook\Options\Mail" -Name "DisableRtfPreview" -Value 1 -PropertyType DWORD -Force | Out-Null

# Disable the ability to open RTF files in Word
New-ItemProperty -Path "HKCU:\Software\Microsoft\Office\*\Word\Security\FileBlock" -Name "RtfFiles" -Value 2 -PropertyType DWORD -Force | Out-Null

# Disable the ability to open RTF files in Excel
New-ItemProperty -Path "HKCU:\Software\Microsoft\Office\*\Excel\Security\FileBlock" -Name "RtfFiles" -Value 2 -PropertyType DWORD -Force | Out-Null
